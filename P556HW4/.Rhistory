err_NBC <- err_NBC_iono
yRange <- c(0, 0.25)
title <- "Errors for Ionosphere Set"
err_KNN <- err_KNN_iono_k1
err_NBC <- err_NBC_iono
yRange <- c(0, 0.25)
source("Prob4-Plot_Helper.R")
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
vld_pred
# Method from textbook p. 160
table(vld_pred, vld_resp)
vld_pred
vld_resp
# Method from textbook p. 160
table(vld_pred, array(vld_resp))
array(vld_resp)
# Method from textbook p. 160
table(vld_pred, matrix(vld_resp, nrow = 1))
matrix(vld_resp, nrow = 1)
vld_resp
# Method from textbook p. 160
table(vld_pred, as.character(vld_resp))
as.character(vld_resp)
vld_resp
as.character(vld_resp)
# Method from textbook p. 160
table(vld_pred, as.character(array(vld_resp)))
array(vld_resp)
as.character(array(vld_resp))
lapply(vld_resp, as.character)
# Method from textbook p. 160
table(vld_pred, lapply(vld_resp, as.character))
# Method from textbook p. 160
table(vld_pred, array(lapply(vld_resp, as.character)))
vld_pred
# Method from textbook p. 160
table(vld_pred, vld_resp)
# Method from textbook p. 160
table(vld_pred, matrix(vld_resp, nrow = 1))
matrix(vld_resp, nrow = 1)
vld_resp
vld_resp[,1]
# Method from textbook p. 160
table(vld_pred, vld_resp[,1])
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
# Method from textbook p. 160
table(vld_pred, vld_resp[,1])
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
# Method from textbook p. 160
table(vld_pred, vld_resp[,1])
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
# Method from textbook p. 160
table(vld_pred, vld_resp[,1])
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
# Method from textbook p. 160
table(vld_pred, vld_resp[,1])
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
# Method from textbook p. 160
table(vld_pred, vld_resp[,1])
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
# Method from textbook p. 160
table(vld_pred, vld_resp[,1])
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
# Method from textbook p. 160
table(vld_pred, vld_resp[,1])
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
# Method from textbook p. 160
table(vld_pred, vld_resp[,1])
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
# Method from textbook p. 160
table(vld_pred, vld_resp[,1])
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
# Method from textbook p. 160
table(vld_pred, vld_resp[,1])
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
# Method from textbook p. 160
table(vld_pred, vld_resp[,1])
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
# Method from textbook p. 160
table(vld_pred, vld_resp[,1])
rm(list = ls())
library(ISLR)
tr_feat <- subset(Weekly, select = Lag2)
vld_feat <- data.frame(matrix(tr_feat[Weekly$Year >= 2009,], ncol = 1))
tr_feat <-  data.frame(matrix(tr_feat[Weekly$Year <= 2008,], ncol = 1))
tr_resp <- subset(Weekly, select = Direction)
vld_resp <- data.frame(matrix(tr_resp[Weekly$Year >= 2009,], ncol = 1))
tr_resp <- tr_resp[Weekly$Year <= 2008,]
vld_pred <- knn(train = tr_feat, test = vld_feat, cl = tr_resp, k = 1)
TP <- vld_pred == "Up" & vld_resp == "Up"
numTP <- sum(TP)
FP <- vld_pred == "Up" & vld_resp == "Down"
numFP <- sum(FP)
TN <- vld_pred == "Down" & vld_resp == "Down"
numTN <- sum(TN)
FN <- vld_pred == "Down" & vld_resp == "Up"
numFN <- sum(FN)
# Method from textbook p. 160
table(vld_pred, vld_resp[,1])
true_resp <- vld_resp[,1]
table(vld_pred, true_resp)
141/252
mean(vld_pred == true_resp)
53/104
# Prob5-13-Plot.R: Make plots for comparison of logistic regression and KNN
rm(list = ls())
# Logit error results
err_logit_0 <- c(0.1089109, 0.1485149, 0.1089109, 0.1386139, 0.06862745)
err_logit_1 <- c(0.1980198, 0.2079208, 0.1188119, 0.1881188, 0.04901961)
err_logit_2 <- c(0.1386139, 0.1782178, 0.1881188, 0.2079208, 0.1666667)
err_logit_3 <- c(0.1683168, 0.2079208, 0.1980198, 0.2079208, 0.1666667)
err_logit_4 <- c(0.2277228, 0.3069307, 0.2277228, 0.2673267, 0.1568627)
err_logit_5 <- c(0.3267327, 0.4356436, 0.2475248, 0.3168317, 0.3431373)
# KNN error results
err_KNN_0 <- c(0.05940594, 0.06930693, 0.07920792, 0.08910891, 0.05882353)
err_KNN_1 <- c(0.1386139, 0.1287129, 0.1683168, 0.1584158, 0.1568627)
err_KNN_2 <- c(0.03960396, 0.1287129, 0.1188119, 0.07920792, 0.04901961)
err_KNN_3 <- c(0.05940594, 0.05940594, 0.1089109, 0.06930693, 0.04901961)
err_KNN_4 <- c(0.01980198, 0.04950495, 0.07920792, 0.07920792, 0)
err_KNN_5 <- c(0.05940594, 0.1089109, 0.07920792, 0.1386139, 0.03921569)
cat("\014")
mean(err_KNN_3)
mean(err_logit_3)
mean(err_KNN_4)
mean(err_logit_4)
mean(err_KNN_5)
mean(err_logit_5)
mean(err_KNN_2)
mean(err_logit_2)
mean(err_logit_1)
mean(err_KNN_1)
rm(list = ls())
